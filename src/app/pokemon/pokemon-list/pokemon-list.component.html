<!-- Barre de recherche pour filtrer les Pokémons par nom -->
<div class="container mb-5">
    <div class="row">
        <div class="col-4 offset-4 mb-3">
            <div class="card">
                <form class="card-body">
                    <div class="form-group">
                        <label for="search" class="form-label">Rechercher un Pokemon</label>
                        <!-- #searchfield : Variable de template pour accéder à l'élément dans le DOM -->
                        <!-- [value] : Liaison unidirectionnelle - affiche la valeur du signal searchTerm -->
                        <!-- (input) : Événement déclenché à chaque frappe - met à jour le signal searchTerm -->
                        <input
                            id="search"
                            type="text"
                            name="searchTerm"
                            class="form-control"
                            placeholder="Rechercher un Pokemon"
                            #searchfield
                            [value]="searchTerm()"
                            [disabled]="this.pokemonListResource.isLoading()"
                            (input)="searchTerm.set(searchfield.value)"
                        />
                        <!-- [disabled] : Désactive le champ pendant le chargement des données -->
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Barre de filtrage par type de Pokémon -->
<div class= "container mb-5">
  <div class="row">
    <div class="col-4 offset-4">
      <!-- Boucle sur tous les types disponibles pour créer des boutons -->
      @for (type of typeList(); track type) {
        <button
        type="button"
        class="btn btn-sm rounded-pill m-1"
        [class.btn-primary]="typeSelected() === type"
        (click)="filterByType(type)"
        >
        {{ type }}
      </button>
      <!-- [class.btn-primary] : Ajoute la classe si ce type est sélectionné (bouton bleu) -->
      <!-- (click) : Toggle le filtre au clic (sélectionne/désélectionne le type) -->
      }
    </div>
  </div>
</div>


<!-- Grille affichant la liste filtrée des Pokémons -->
<div class="container">
    <div class="row">
      <!-- @if : Syntaxe de flux de contrôle Angular 17+ - Affiche le spinner pendant le chargement -->
      <!-- .isLoading() : Méthode de httpResource qui retourne true pendant la requête HTTP -->
      @if (this.pokemonListResource.isLoading()) {
        <div class="d-flex justify-content-center">
          <div class="spinner-border text-success" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
        </div>
      }
        <!-- @for : Boucle sur la liste filtrée des Pokémons - track pokemon.id pour les performances -->
        @for (pokemon of pokemonListFiltered(); track pokemon.id) {
            <div class="col-md-4 pokemon-card">
                <!-- appPokemanBorder : Directive personnalisée pour l'effet de bordure au survol -->
                <!-- [routerLink] : Navigation vers le profil détaillé au clic sur la carte -->
                <div class="card mb-3"
                  appPokemanBorder
                  [pokemonType]="pokemon.types[0]"
                  >
                    <div class="row g-0">
                        <!-- Image du Pokémon -->
                        <div class="col-md-4 d-flex align-items-center justify-content-center bg-light">
                            <img
                                class="img-fluid rounded-start"
                                [src]="pokemon.picture"
                                [alt]="pokemon.name"
                            />
                        </div>
                        <!-- Informations du Pokémon -->
                        <div class="col-md-8">
                            <div class="card-body">
                                <h5 class="card-title">{{ pokemon.name }}</h5>
                                <!-- {{ }} : Interpolation - affiche une valeur dynamique -->
                                <p>Taille: {{ size(pokemon) }}</p>
                                <!-- | date : Pipe Angular pour formater la date -->
                                <p class ="card-text">{{ pokemon.created | date: "dd/MM/yyyy" }}</p>
                                <!-- Lien cliquable pour voir le profil détaillé du Pokémon -->
                                <p class="card-text" [routerLink]="['/pokemons', pokemon.id]">voir ce pokemon</p>
                                <!-- Bouton de suppression optimiste (retire de l'affichage sans appel API) -->
                                <p class="card-text" (click)="removePokemon(pokemon)">Supprimer ce Pokémon</p>
                                <p class="card-text">
                            </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
</div>

<!-- Bouton flottant "+" pour ajouter un nouveau Pokémon (position fixe en bas à droite) -->
<div class="position-fixed bottom-0 end-0 m-3">
      <button
        class="btn btn-success rounded-circle btn-lg"
        type="button"
        [routerLink]="['/pokemons', 'add']"
      >
        +
      </button>
    </div>
